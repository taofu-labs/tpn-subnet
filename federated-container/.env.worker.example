# TPN Federated Network - Worker Node Configuration
# Copy this file to .env and fill in your values
# Workers use the --profile worker flag: docker-compose --profile worker up -d

# ========================================
# === MANDATORY CONFIGURATION ===
# ========================================
# These settings MUST be configured for the worker to work properly

# Mining pool configuration (chooses a default one when unset)
MINING_POOL_URL=

# Public Access Configuration (REQUIRED)
SERVER_PUBLIC_PROTOCOL=http
SERVER_PUBLIC_HOST=localhost
SERVER_PUBLIC_PORT=3000

# PostgreSQL Configuration (REQUIRED)
POSTGRES_PASSWORD=your_postgres_password_here

# Worker Payment Configuration (REQUIRED)
PAYMENT_ADDRESS_EVM=0x1234567890123456789012345678901234567890
PAYMENT_ADDRESS_BITTENSOR=5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY

# ========================================
# === OPTIONAL CONFIGURATION ===
# ========================================
# These settings have sensible defaults but can be customized

# Shared Configuration
LOG_LEVEL=info
POSTGRES_DB=postgres
POSTGRES_USER=postgres
# Node.js Runtime Configuration - Memory limit in MB
# To get your system's available memory: echo $(($(free -m | awk 'NR==2{print $2}') * 3 / 4))
CONTAINER_MAX_PROCESS_RAM_MB=8192

# Worker Configuration
BROADCAST_MESSAGE="Optional broadcast message"
CONTACT_METHOD="email@example.com or telegram @username"

# WireGuard VPN Configuration
WIREGUARD_SERVERURL=auto
WIREGUARD_SERVERPORT=51820
WIREGUARD_PEERS=254
WIREGUARD_PEERDNS=auto
WIREGUARD_INTERNAL_SUBNET=10.13.13.0
WIREGUARD_ALLOWEDIPS=0.0.0.0/0
WIREGUARD_LOG_CONFS=true

# Monitoring Configuration
WATCHTOWER_POLL_INTERVAL=3600
WATCHTOWER_NOTIFICATIONS=
WATCHTOWER_NOTIFICATION_URL=
AUTOHEAL_INTERVAL=5
AUTOHEAL_START_PERIOD=0
AUTOHEAL_DEFAULT_STOP_TIMEOUT=10

# Network Configuration
TZ=UTC
TPN_INTERNAL_SUBNET=172.20.0.0/16
TPN_INTERNAL_GATEWAY=172.20.0.1
TPN_EXTERNAL_SUBNET=172.21.0.0/16
TPN_EXTERNAL_GATEWAY=172.21.0.1

# ========================================
# === DEPLOYMENT NOTES ===
# ========================================
# Workers do not need SWAG reverse proxy configuration as they only serve
# other containers within the TPN network through mining pools.
# The localhost port 3000 binding allows the local neuron to communicate
# with the worker container directly.
